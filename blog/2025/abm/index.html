<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Agent-Based Models | Maaike M. H. van Swieten </title> <meta name="author" content="Maaike M. H. van Swieten"> <meta name="description" content="What are ABMs and how to implement them"> <meta name="keywords" content="Neuroscience, Data Science, Machine Learning, Cancer Epidemiology, Large Language Models"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.ico?417549ccc4b6ad232e5454a4d4dc3ab4"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://maaikevs.github.io/blog/2025/abm/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Maaike</span> M. H. van Swieten </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">Search <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Agent-Based Models</h1> <p class="post-meta"> Created in February 08, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/code"> <i class="fa-solid fa-hashtag fa-sm"></i> Code</a>   <a href="/blog/tag/r"> <i class="fa-solid fa-hashtag fa-sm"></i> R</a>   <a href="/blog/tag/python"> <i class="fa-solid fa-hashtag fa-sm"></i> python</a>   ·   <a href="/blog/category/implementation"> <i class="fa-solid fa-tag fa-sm"></i> implementation</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="what-are-agent-based-models-abms">What are Agent-Based Models (ABMs)?</h2> <p>Agent-based models (ABMs) are computational simulation models that represent complex systems through the interactions of individual entities, called “agents.” These agents follow defined rules and behaviors, interacting with each other and their environment over time. ABMs are particularly useful for modeling systems with heterogeneous elements, emergent behaviors, and stochastic dynamics.</p> <h3 id="key-features-of-abms">Key Features of ABMs:</h3> <ul> <li> <strong>Agents:</strong> Represent individual entities with attributes (e.g., cancer cells, immune cells, patients).</li> <li> <strong>Rules:</strong> Govern agent behaviors (e.g., proliferation, migration, apoptosis).</li> <li> <strong>Environment:</strong> The space where agents interact (e.g., tumor microenvironment).</li> <li> <strong>Interactions:</strong> Agents interact based on defined mechanisms (e.g., cell signaling, competition for resources).</li> <li> <strong>Stochasticity:</strong> Random events influence system evolution (e.g., mutations, drug resistance).</li> </ul> <h3 id="steps-to-implement">Steps to Implement:</h3> <ol> <li> <strong>Define Agents and States:</strong> Map out the model structure.</li> <li> <strong>Specify Transition Rules:</strong> Define the likelihood of transitioning into another state.</li> <li> <strong>Set Up the Environment:</strong> Define spatial structure or non-spatial interactions.</li> <li> <strong>Incorporate Stochasticity:</strong> Introduce random factors.</li> <li> <strong>Simulation Execution:</strong> Run simulations over time to observe emergent patterns. . <strong>Analysis and Visualization:</strong> Use statistical tools and visualization libraries (e.g., Matplotlib, Gephi).</li> </ol> <h3 id="simple-example-scenario">Simple example scenario</h3> <p><strong>Scenario:</strong></p> <ul> <li>Simulating the growth of a heterogeneous tumor in response to chemotherapy.</li> </ul> <p><strong>Agents:</strong></p> <ul> <li>Tumor cells (can be in different states: “sensitive,” “resistant,” or “dead”)</li> </ul> <p>Not included in simple model:</p> <ul> <li>Immune cells (attack tumor cells)</li> <li>Drug molecules (affect tumor cells)</li> </ul> <p><strong>States and Transitions:</strong></p> <ul> <li>Sensitive cells → Become resistant due to mutations (probabilistic transition).</li> <li>Resistant cells → Survive treatment but might be targeted by immune cells.</li> <li>Dead cells → Removed from the environment.</li> </ul> <pre><code class="language-mermaid">stateDiagram-v2
direction LR
   sensitive cells --&gt; resistent cells
   resistent cells --&gt; dead cells
   sensitive cells --&gt; dead cells
   sensitive cells --&gt; sensitive cells
   resistent cells --&gt; resistent cells
   dead cells --&gt; dead cells
</code></pre> <p><strong>Environment:</strong></p> <ul> <li>A 2D lattice representing the tumor microenvironment where cells move and interact.</li> </ul> <p><strong>Simulation Objectives:</strong></p> <ul> <li>Observe how tumors evolve resistance over time.</li> <li>Evaluate the effectiveness of combination therapies.</li> <li>Predict the likelihood of recurrence after treatment cessation.</li> </ul> <p><strong>Key Insights Gained:</strong></p> <ul> <li>The role of spatial heterogeneity in treatment success.</li> <li>Potential timing for combination therapies to prevent resistance.</li> <li>How immune system dynamics influence tumor eradication.</li> </ul> <h3 id="implementation">Implementation</h3> <ul id="abm" class="tab" data-tab="a93d89eb-bdbc-487d-82d4-8740e670542c" data-name="abm"> <li class="active" id="abm-r"> <a href="#">R </a> </li> <li id="abm-python"> <a href="#">python </a> </li> </ul> <ul class="tab-content" id="a93d89eb-bdbc-487d-82d4-8740e670542c" data-name="abm"> <li class="active"> <div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w">

</span><span class="c1"># Develop the agent and the states</span><span class="w">
</span><span class="n">initialize_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">initial_cells</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">cells</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.table</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">initial_cells</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sensitive"</span><span class="p">)</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">cells</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cells</span><span class="p">,</span><span class="w"> </span><span class="n">cycle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># Define the time course of the model</span><span class="w">
</span><span class="n">apply_chemotherapy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">chemo_kill_prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">mutation_prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">model</span><span class="o">$</span><span class="n">cycle</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model</span><span class="o">$</span><span class="n">cycle</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="w">
  
  </span><span class="c1"># Kill sensitive cells</span><span class="w">
  </span><span class="n">kill_ids</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model</span><span class="o">$</span><span class="n">cells</span><span class="p">[</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"sensitive"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">runif</span><span class="p">(</span><span class="n">.N</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">chemo_kill_prob</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">]</span><span class="w">
  </span><span class="n">model</span><span class="o">$</span><span class="n">cells</span><span class="p">[</span><span class="n">id</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">kill_ids</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">"dead"</span><span class="p">]</span><span class="w">
  
  </span><span class="c1"># Mutate some surviving sensitive cells to resistant</span><span class="w">
  </span><span class="n">mutate_ids</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model</span><span class="o">$</span><span class="n">cells</span><span class="p">[</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"sensitive"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">runif</span><span class="p">(</span><span class="n">.N</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">mutation_prob</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">]</span><span class="w">
  </span><span class="n">model</span><span class="o">$</span><span class="n">cells</span><span class="p">[</span><span class="n">id</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">mutate_ids</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s2">"resistant"</span><span class="p">]</span><span class="w">
  
  </span><span class="nf">return</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># Update the agent based on transition probabilities</span><span class="w">
</span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">initialize_model</span><span class="p">()</span><span class="w">
</span><span class="n">results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply_chemotherapy</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w">
  </span><span class="n">results</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.table</span><span class="p">(</span><span class="n">cycle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> 
                              </span><span class="n">sensitive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">model</span><span class="o">$</span><span class="n">cells</span><span class="o">$</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"sensitive"</span><span class="p">),</span><span class="w">
                              </span><span class="n">resistant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">model</span><span class="o">$</span><span class="n">cells</span><span class="o">$</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"resistant"</span><span class="p">),</span><span class="w">
                              </span><span class="n">dead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">model</span><span class="o">$</span><span class="n">cells</span><span class="o">$</span><span class="n">state</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"dead"</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbindlist</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="w">

</span><span class="c1"># Visualize the results</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cycle</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sensitive</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sensitive"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resistant</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Resistant"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dead</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Dead"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Tumor Cell Dynamics Over Chemotherapy Cycles"</span><span class="p">,</span><span class="w">
       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Chemotherapy Cycle"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Cell Count"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Cell Type"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">

</span></code></pre></div></div> </li> <li> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># Initialize model
</span><span class="k">def</span> <span class="nf">initialize_model</span><span class="p">(</span><span class="n">initial_cells</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">cells</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
        <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">initial_cells</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">sensitive</span><span class="sh">'</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">:</span> <span class="n">cells</span><span class="p">,</span> <span class="sh">'</span><span class="s">cycle</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="c1"># Apply chemotherapy
</span><span class="k">def</span> <span class="nf">apply_chemotherapy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">chemo_kill_prob</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">mutation_prob</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cycle</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="c1"># Kill sensitive cells
</span>    <span class="n">kill_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">sensitive</span><span class="sh">'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="n">chemo_kill_prob</span><span class="p">)</span>
    <span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">].</span><span class="n">loc</span><span class="p">[</span><span class="n">kill_mask</span><span class="p">,</span> <span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">dead</span><span class="sh">'</span>
    
    <span class="c1"># Mutate some surviving sensitive cells to resistant
</span>    <span class="n">mutate_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">sensitive</span><span class="sh">'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="n">mutation_prob</span><span class="p">)</span>
    <span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">].</span><span class="n">loc</span><span class="p">[</span><span class="n">mutate_mask</span><span class="p">,</span> <span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">resistant</span><span class="sh">'</span>
    
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Run the simulation
</span><span class="n">model</span> <span class="o">=</span> <span class="nf">initialize_model</span><span class="p">()</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="nf">apply_chemotherapy</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">results</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
        <span class="sh">'</span><span class="s">cycle</span><span class="sh">'</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">sensitive</span><span class="sh">'</span><span class="p">:</span> <span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">sensitive</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">(),</span>
        <span class="sh">'</span><span class="s">resistant</span><span class="sh">'</span><span class="p">:</span> <span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">resistant</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">(),</span>
        <span class="sh">'</span><span class="s">dead</span><span class="sh">'</span><span class="p">:</span> <span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="sh">'</span><span class="s">cells</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">state</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">dead</span><span class="sh">'</span><span class="p">).</span><span class="nf">sum</span><span class="p">()</span>
    <span class="p">})</span>

<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># Visualize the results
</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="sh">'</span><span class="s">cycle</span><span class="sh">'</span><span class="p">],</span> <span class="n">results_df</span><span class="p">[</span><span class="sh">'</span><span class="s">sensitive</span><span class="sh">'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Sensitive</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="sh">'</span><span class="s">cycle</span><span class="sh">'</span><span class="p">],</span> <span class="n">results_df</span><span class="p">[</span><span class="sh">'</span><span class="s">resistant</span><span class="sh">'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Resistant</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">s</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">results_df</span><span class="p">[</span><span class="sh">'</span><span class="s">cycle</span><span class="sh">'</span><span class="p">],</span> <span class="n">results_df</span><span class="p">[</span><span class="sh">'</span><span class="s">dead</span><span class="sh">'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Dead</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Chemotherapy Cycle</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Cell Count</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Tumor Cell Dynamics Over Chemotherapy Cycles</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</code></pre></div></div> </li> </ul> <p>The figure will look something like this:</p> <pre><code class="language-chartjs">{
  "type": "line",
  "data": {
    "labels": [
      1,2,3,4,5,6
    ],
    "datasets": [
      {
        "label": "Sensitive cells",
        "fill": false,
        "lineTension": 0.1,
        "backgroundColor": "rgba(75,192,192,0.4)",
        "borderColor": "rgba(75,192,192,1)",
        "borderCapStyle": "butt",
        "borderDash": [],
        "borderDashOffset": 0,
        "borderJoinStyle": "miter",
        "pointBorderColor": "rgba(75,192,192,1)",
        "pointBackgroundColor": "#fff",
        "pointBorderWidth": 1,
        "pointHoverRadius": 5,
        "pointHoverBackgroundColor": "rgba(75,192,192,1)",
        "pointHoverBorderColor": "rgba(220,220,220,1)",
        "pointHoverBorderWidth": 2,
        "pointRadius": 1,
        "pointHitRadius": 10,
        "data": [
          33,
          10,
          2,
          0,
          0,
          0
        ],
        "spanGaps": false
      },
      {
        "label": "Resistant cells",
        "fill": false,
        "lineTension": 0.1,
        "backgroundColor": "rgba(75,192,192,0.4)",
        "borderColor": "rgba(75,192,192,1)",
        "borderCapStyle": "butt",
        "borderDash": [],
        "borderDashOffset": 0,
        "borderJoinStyle": "miter",
        "pointBorderColor": "rgba(75,192,192,1)",
        "pointBackgroundColor": "#fff",
        "pointBorderWidth": 1,
        "pointHoverRadius": 5,
        "pointHoverBackgroundColor": "rgba(75,192,192,1)",
        "pointHoverBorderColor": "rgba(220,220,220,1)",
        "pointHoverBorderWidth": 2,
        "pointRadius": 1,
        "pointHitRadius": 10,
        "data": [
            5,6,6,6,6,6
        ],
        "spanGaps": false
      },
      ,
      {
        "label": "Dead cells",
        "fill": false,
        "lineTension": 0.1,
        "backgroundColor": "rgba(75,192,192,0.4)",
        "borderColor": "rgba(75,192,192,1)",
        "borderCapStyle": "butt",
        "borderDash": [],
        "borderDashOffset": 0,
        "borderJoinStyle": "miter",
        "pointBorderColor": "rgba(75,192,192,1)",
        "pointBackgroundColor": "#fff",
        "pointBorderWidth": 1,
        "pointHoverRadius": 5,
        "pointHoverBackgroundColor": "rgba(75,192,192,1)",
        "pointHoverBorderColor": "rgba(220,220,220,1)",
        "pointHoverBorderWidth": 2,
        "pointRadius": 1,
        "pointHitRadius": 10,
        "data": [
            62,84,92,94,94,94
        ],
        "spanGaps": false
      }
    ]
  },
  "options": {}
}
</code></pre> <h3 id="advantages-of-abms">Advantages of ABMs</h3> <ul> <li>Captures Complexity: Represents heterogeneous cancer cell behavior.</li> <li>Personalized Insights: Simulates patient-specific scenarios.</li> <li>Exploration of Rare Events: Tests unlikely but possible outcomes.</li> <li>Hypothesis Testing: Evaluates treatment strategies before clinical trials.</li> </ul> <h3 id="challenges-of-abms">Challenges of ABMs</h3> <ul> <li>Computational Cost: Large-scale simulations require high resources.</li> <li>Model Validation: Requires experimental data for accuracy.</li> <li>Parameter Uncertainty: Difficult to determine precise transition probabilities.</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/post-citation/">a post that can be cited</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/pseudocode/">a post with pseudo code</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/advanced-images/">a post with advanced image components</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Maaike M. H. van Swieten. Last updated: February 08, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js" integrity="sha256-1rA678n2xEx7x4cTZ5x4wpUCj6kUMZEZ5cxLSVSFWxw=" crossorigin="anonymous"></script> <script defer src="/assets/js/mermaid-setup.js?38ca0a0126f7328d2d9a46bad640931f" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" integrity="sha256-0q+JdOlScWOHcunpUk21uab1jW7C1deBQARHtKMcaB4=" crossorigin="anonymous"></script> <script defer src="/assets/js/chartjs-setup.js?183c5859923724fb1cb3c67593848e71" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/tabs.min.js?b8748955e1076bbe0dabcf28f2549fdc"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>